"use strict";(self.webpackChunkbrige_typescript=self.webpackChunkbrige_typescript||[]).push([[5010],{5010:(e,t,n)=>{n.r(t),n.d(t,{B:()=>f,S:()=>ve,a:()=>z,b:()=>q,c:()=>P,d:()=>D,e:()=>k,f:()=>L,g:()=>ye,h:()=>b,i:()=>w,j:()=>de,k:()=>y,l:()=>N,m:()=>he,n:()=>A,o:()=>O,p:()=>Ie});var r=n(9379),i=n(8951),a=n(9495),s=n(6218),o=n(600),c=n(1640),u=n(9122),d=n(8456),g=n(8338),m=n(7605),l=Object.defineProperty,p=(e,t,n)=>((e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const f=new c.P("BPFLoaderUpgradeab1e11111111111111111111111");function y(e){return(0,d.d)([new c.P(e).toBuffer()],f)}class h extends Error{constructor(e){super(e),this.name="IdlError"}}function w(e,t){switch(t.type.kind){case"struct":return t.type.fields.map(t=>S(e,t.type)).reduce((e,t)=>e+t,0);case"enum":{const n=t.type.variants.map(t=>t.fields?t.fields.map(t=>S(e,"object"==typeof t&&"name"in t?t.type:t)).reduce((e,t)=>e+t,0):0);return Math.max(...n)+1}case"alias":return S(e,t.type.value)}}function S(e,t){var n;switch(t){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"u256":case"i256":case"publicKey":return 32;default:if("vec"in t)return 1;if("option"in t)return 1+S(e,t.option);if("coption"in t)return 4+S(e,t.coption);if("defined"in t){var r;const i=null!==(r=null==(n=e.types)?void 0:n.filter(e=>e.name===t.defined))&&void 0!==r?r:[];if(1!==i.length)throw new h("Type not found: ".concat(JSON.stringify(t)));return w(e,i[0])}if("array"in t){let n=t.array[0],r=t.array[1];return S(e,n)*r}throw new Error("Invalid type ".concat(JSON.stringify(t)))}}function v(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()}).replace(/[\s\-_]+/g,"")}const I=[{name:"discriminator",binary:"bytes",size:4},{name:"consistencyLevel",binary:"uint",size:1,endianness:"little"},(0,r.A)({name:"emitterAuthority"},c.ar),{name:"messageStatus",binary:"uint",size:1,endianness:"little"},{name:"gap",binary:"uint",size:3},{name:"timestamp",binary:"uint",size:4,endianness:"little"},{name:"nonce",binary:"uint",size:4,endianness:"little"},{name:"sequence",binary:"uint",size:8,endianness:"little"},{name:"emitterChain",binary:"uint",size:2,endianness:"little"},(0,r.A)({name:"emitterAddress"},c.ar),{name:"payloadLength",binary:"uint",size:4,endianness:"little"},{name:"payload",binary:"bytes"}];function M(e){return(0,c.aJ)(I,e)}function b(e,t,n,r){const i="string"==typeof t?c.d.Buffer.from(t,"hex"):c.d.Buffer.from(t);if(32!=i.length)throw Error("address.length != 32");const a=c.d.Buffer.alloc(8);return a.writeBigUInt64BE("number"==typeof r?BigInt(r):r),(0,d.d)([i,(()=>{const e=c.d.Buffer.alloc(2);return e.writeUInt16BE(n),e})(),a],e)}async function A(e,t,n,r,i,a){return e.getAccountInfo(b(t,n,r,i),a).then(e=>!!(0,d.g)(e)[0])}function P(e){return(0,d.d)([c.d.Buffer.from("Bridge")],e)}async function x(e,t,n){return e.getAccountInfo(P(t),n).then(e=>E.deserialize((0,d.g)(e)))}class B{constructor(e,t){p(this,"guardianSetExpirationTime"),p(this,"fee"),this.guardianSetExpirationTime=e,this.fee=t}static deserialize(e){if(12!=e.length)throw new Error("data.length != 12");const t=e.readUInt32LE(0),n=e.readBigUInt64LE(4);return new B(t,n)}}class E{constructor(e,t,n){p(this,"guardianSetIndex"),p(this,"lastLamports"),p(this,"config"),this.guardianSetIndex=e,this.lastLamports=t,this.config=n}static deserialize(e){if(24!=e.length)throw new Error("data.length != 24");const t=e.readUInt32LE(0),n=e.readBigUInt64LE(4),r=B.deserialize(e.subarray(12));return new E(t,n,r)}}function L(e,t){return(0,d.d)([c.d.Buffer.from("Sequence"),new c.P(e).toBytes()],t)}async function U(e,t,n,r){return e.getAccountInfo(L(t,n),r).then(e=>C.deserialize((0,d.g)(e)))}class C{constructor(e,t,n){p(this,"sequence"),p(this,"bump"),p(this,"emitterType"),this.sequence=e,this.bump=t,this.emitterType=n}static deserialize(e){if(8!==e.length&&10!==e.length)throw new Error("data.length != 8 or data.length != 10");let t,n;const r=e.readBigUInt64LE(0);return 10===e.length&&(t=e[8],n=e[9]),new C(r,t,n)}value(){return this.sequence}}function k(e){return(0,d.d)([c.d.Buffer.from("emitter")],e)}function T(e,t){const n=k(e);return{emitter:n,sequence:L(n,t)}}async function q(e,t,n,r){return U(e,k(t),n,r)}function z(e){return(0,d.d)([c.d.Buffer.from("fee_collector")],e)}function F(e,t,n){return new c.a4({keys:[],programId:c.du.programId,data:K.serialize(e,t,n)})}class K{static serialize(e,t,n){if(0==e.length)throw Error("signatures.length == 0");if(e.length!=t.length)throw Error("signatures.length != keys.length");if(32!=n.length)throw Error("message.length != 32");const r=e.length,i=11,a=1+r*i,s=a+85*r,o=c.d.Buffer.alloc(s+32);o.writeUInt8(r,0),o.write(n.toString("hex"),s,"hex");for(let c=0;c<r;++c){const n=e.at(c);if(65!=(null==n?void 0:n.length))throw Error("signatures[".concat(c,"].length != 65"));const r=t.at(c);if(20!=(null==r?void 0:r.length))throw Error("keys[".concat(c,"].length != 20"));const u=a+85*c,d=u+65;o.writeUInt16LE(u,1+c*i),o.writeUInt8(0,3+c*i),o.writeUInt16LE(d,4+c*i),o.writeUInt8(0,6+c*i),o.writeUInt16LE(s,7+c*i),o.writeUInt16LE(32,9+c*i),o.writeUInt8(0,10+c*i),o.write(n.toString("hex"),u,"hex"),o.write(r.toString("hex"),d,"hex")}return o}}function _(e,t){return(0,d.d)([c.d.Buffer.from("GuardianSet"),(()=>{const e=c.d.Buffer.alloc(4);return e.writeUInt32BE(t),e})()],e)}async function V(e,t,n,r){return e.getAccountInfo(_(t,n),r).then(e=>W.deserialize((0,d.g)(e)))}class W{constructor(e,t,n,r){p(this,"index"),p(this,"keys"),p(this,"creationTime"),p(this,"expirationTime"),this.index=e,this.keys=t,this.creationTime=n,this.expirationTime=r}static deserialize(e){const t=e.readUInt32LE(0),n=e.readUInt32LE(4),r=8+20*n,i=e.readUInt32LE(r),a=e.readUInt32LE(4+r),s=[];for(let o=0;o<n;++o){const t=8+20*o;s.push(e.subarray(t,t+20))}return new W(t,s,i,a)}}function D(e,t){return(0,d.d)([c.d.Buffer.from("PostedVAA"),t],e)}class G{constructor(e,t,n){p(this,"signatures"),p(this,"hash"),p(this,"guardianSetIndex"),this.signatures=e,this.hash=t,this.guardianSetIndex=n}static deserialize(e){const t=e.readUInt32LE(0),n=[...e.subarray(4,4+t)].map(e=>0!=e),r=4+t,i=e.subarray(r,r+32),a=e.readUInt32LE(r+32);return new G(n,i,a)}}function N(e){return(0,d.d)([c.d.Buffer.from("upgrade")],e)}function O(e,t,n){return c.$.transfer({fromPubkey:new c.P(t),toPubkey:z(e),lamports:n})}class ${constructor(e){p(this,"idl"),this.idl=e}async encode(e,t){throw new Error("Invalid account name: ".concat(e))}decode(e,t){return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){throw new Error("Invalid account name: ".concat(e))}memcmp(e,t){if("postVaa"===e)return{dataSize:56};throw new Error("Invalid account name: ".concat(e))}size(e){var t;return null!==(t=w(this.idl,e))&&void 0!==t?t:0}}class j{constructor(e){}decode(e){throw new Error("Wormhole program does not have events")}}class J{static fieldLayout(e,t){const n=void 0!==e.name?v(e.name):void 0;switch(e.type){case"bool":return u.d.bool(n);case"u8":return u.d.u8(n);case"i8":return u.d.i8(n);case"u16":return u.d.u16(n);case"i16":return u.d.i16(n);case"u32":return u.d.u32(n);case"i32":return u.d.i32(n);case"f32":return u.d.f32(n);case"u64":return u.d.u64(n);case"i64":return u.d.i64(n);case"f64":return u.d.f64(n);case"u128":return u.d.u128(n);case"i128":return u.d.i128(n);case"u256":return u.d.u256(n);case"i256":return u.d.i256(n);case"bytes":return u.d.vecU8(n);case"string":return u.d.str(n);case"publicKey":return u.d.publicKey(n);default:if("vec"in e.type)return u.d.vec(J.fieldLayout({name:void 0,type:e.type.vec},t),n);if("option"in e.type)return u.d.option(J.fieldLayout({name:void 0,type:e.type.option},t),n);if("array"in e.type){let r=e.type.array[0],i=e.type.array[1],a=J.fieldLayout({name:void 0,type:r},t);return u.d.array(a,i,n)}throw new Error("Not yet implemented: ".concat(e))}}}class R{constructor(e){p(this,"ixLayout"),this.ixLayout=R.parseIxLayout(e)}static parseIxLayout(e){const t=(e.instructions?e.instructions:[]).map(t=>{let n=t.args.map(t=>{var n,r;return J.fieldLayout(t,Array.from([...null!==(n=e.accounts)&&void 0!==n?n:[],...null!==(r=e.types)&&void 0!==r?r:[]]))});const r=v(t.name);return[r,u.d.struct(n,r)]}).concat(e.instructions.map(t=>{let n=t.args.map(t=>{var n,r;return J.fieldLayout(t,Array.from([...null!==(n=e.accounts)&&void 0!==n?n:[],...null!==(r=e.types)&&void 0!==r?r:[]]))});const r=v(t.name);return[r,u.d.struct(n,r)]}));return new Map(t)}encode(e,t){const n=c.d.Buffer.alloc(1e3),r=v(e),i=this.ixLayout.get(r);if(!i)throw new Error("Unknown method: ".concat(r));const a=i.encode(t,n),s=n.slice(0,a);return function(e,t){const n=c.d.Buffer.alloc(1+(void 0===t?0:t.length));return n.writeUInt8(e,0),void 0!==t&&n.write(t.toString("hex"),1,"hex"),n}(Z[(o=r,o.charAt(0).toUpperCase()+o.slice(1))],s);var o}encodeState(e,t){throw new Error("Wormhole program does not have state")}decode(e){var t;var n;"string"==typeof e&&(e="hex"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hex")?c.d.Buffer.from(e,"hex"):c.cg.decode(e));let r=c.d.Buffer.from(e.slice(0,1)).readInt8(),i=c.d.Buffer.from(e.slice(1)),a=v(null!==(t=Z[r])&&void 0!==t?t:"");return this.ixLayout.get(a)?{data:null==(n=this.ixLayout.get(a))?void 0:n.decode(i),name:a}:null}}var Z,H;(H=Z||(Z={}))[H.Initialize=0]="Initialize",H[H.PostMessage=1]="PostMessage",H[H.PostVaa=2]="PostVaa",H[H.SetFees=3]="SetFees",H[H.TransferFees=4]="TransferFees",H[H.UpgradeContract=5]="UpgradeContract",H[H.UpgradeGuardianSet=6]="UpgradeGuardianSet",H[H.VerifySignatures=7]="VerifySignatures",H[H.PostMessageUnreliable=8]="PostMessageUnreliable";class Q{constructor(e){}encode(e,t){throw new Error("Wormhole program does not have state")}decode(e){throw new Error("Wormhole program does not have state")}}class X{constructor(e){}encode(e,t){throw new Error("Wormhole program does not have user-defined types")}decode(e,t){throw new Error("Wormhole program does not have user-defined types")}}class Y{constructor(e){p(this,"instruction"),p(this,"accounts"),p(this,"state"),p(this,"events"),p(this,"types"),this.instruction=new R(e),this.accounts=new $(e),this.state=new Q(e),this.events=new j(e),this.types=new X(e)}}const ee={version:"0.1.0",name:"wormhole",instructions:[{name:"initialize",accounts:[{name:"bridge",isMut:!0,isSigner:!1},{name:"guardianSet",isMut:!0,isSigner:!1},{name:"feeCollector",isMut:!0,isSigner:!1},{name:"payer",isMut:!0,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"guardianSetExpirationTime",type:"u32"},{name:"fee",type:"u64"},{name:"initialGuardians",type:{vec:{array:["u8",20]}}}]},{name:"postMessage",accounts:[{name:"bridge",isMut:!0,isSigner:!1},{name:"message",isMut:!0,isSigner:!0},{name:"emitter",isMut:!1,isSigner:!0},{name:"sequence",isMut:!0,isSigner:!1},{name:"payer",isMut:!0,isSigner:!0},{name:"feeCollector",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"nonce",type:"u32"},{name:"payload",type:"bytes"},{name:"consistencyLevel",type:"u8"}]},{name:"postVaa",accounts:[{name:"guardianSet",isMut:!1,isSigner:!1},{name:"bridge",isMut:!1,isSigner:!1},{name:"signatureSet",isMut:!1,isSigner:!1},{name:"vaa",isMut:!0,isSigner:!1},{name:"payer",isMut:!0,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"version",type:"u8"},{name:"guardianSetIndex",type:"u32"},{name:"timestamp",type:"u32"},{name:"nonce",type:"u32"},{name:"emitterChain",type:"u16"},{name:"emitterAddress",type:{array:["u8",32]}},{name:"sequence",type:"u64"},{name:"consistencyLevel",type:"u8"},{name:"payload",type:"bytes"}]},{name:"setFees",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"bridge",isMut:!0,isSigner:!1},{name:"vaa",isMut:!1,isSigner:!1},{name:"claim",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"transferFees",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"bridge",isMut:!0,isSigner:!1},{name:"vaa",isMut:!1,isSigner:!1},{name:"claim",isMut:!0,isSigner:!1},{name:"feeCollector",isMut:!0,isSigner:!1},{name:"recipient",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"upgradeContract",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"bridge",isMut:!0,isSigner:!1},{name:"vaa",isMut:!1,isSigner:!1},{name:"claim",isMut:!0,isSigner:!1},{name:"upgradeAuthority",isMut:!1,isSigner:!1},{name:"spill",isMut:!0,isSigner:!1},{name:"implementation",isMut:!0,isSigner:!1},{name:"programData",isMut:!0,isSigner:!1},{name:"wormholeProgram",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"bpfLoaderUpgradeable",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"upgradeGuardianSet",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"bridge",isMut:!0,isSigner:!1},{name:"vaa",isMut:!1,isSigner:!1},{name:"claim",isMut:!0,isSigner:!1},{name:"guardianSetOld",isMut:!0,isSigner:!1},{name:"guardianSetNew",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"verifySignatures",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"guardianSet",isMut:!1,isSigner:!1},{name:"signatureSet",isMut:!0,isSigner:!0},{name:"instructions",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"signatureStatus",type:{array:["i8",19]}}]},{name:"postMessageUnreliable",accounts:[{name:"bridge",isMut:!0,isSigner:!1},{name:"message",isMut:!0,isSigner:!0},{name:"emitter",isMut:!1,isSigner:!0},{name:"sequence",isMut:!0,isSigner:!1},{name:"payer",isMut:!0,isSigner:!0},{name:"feeCollector",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"nonce",type:"u32"},{name:"payload",type:"bytes"},{name:"consistencyLevel",type:"u8"}]}],accounts:[{name:"PostedMessage",type:{kind:"struct",fields:[{name:"vaaVersion",type:"u8"},{name:"consistencyLevel",type:"u8"},{name:"vaaTime",type:"u32"},{name:"vaaSignatureAccount",type:"publicKey"},{name:"submissionTime",type:"u32"},{name:"nonce",type:"u32"},{name:"sequence",type:"u64"},{name:"emitterChain",type:"u16"},{name:"emitterAddress",type:{array:["u8",32]}},{name:"payload",type:"bytes"}]}},{name:"PostedVAA",type:{kind:"struct",fields:[{name:"vaaVersion",type:"u8"},{name:"consistencyLevel",type:"u8"},{name:"vaaTime",type:"u32"},{name:"vaaSignatureAccount",type:"publicKey"},{name:"submissionTime",type:"u32"},{name:"nonce",type:"u32"},{name:"sequence",type:"u64"},{name:"emitterChain",type:"u16"},{name:"emitterAddress",type:{array:["u8",32]}},{name:"payload",type:"bytes"}]}}]};function te(e,t){return new u.P(ee,new c.P(e),void 0===t?{connection:null}:t,re())}function ne(e,t){return te(e,(0,u.c)(t))}function re(){return new Y(ee)}function ie(e,t,n){return{payer:new c.P(t),bridge:P(e),vaa:D(e,c.d.Buffer.from(n.hash)),claim:b(e,n.emitterAddress.toString(),(0,c.ax)(n.emitterChain),n.sequence),systemProgram:c.$.programId}}function ae(e,t,n,r){return{payer:new c.P(t),bridge:P(e),vaa:D(e,c.d.Buffer.from(r.hash)),claim:b(e,r.emitterAddress.toString(),(0,c.ax)(r.emitterChain),r.sequence),feeCollector:z(e),recipient:new c.P(n),rent:c.a2,systemProgram:c.$.programId}}function se(e,t,n){return{payer:new c.P(t),bridge:P(e),vaa:D(e,c.d.Buffer.from(n.hash)),claim:b(e,n.emitterAddress.toString(),(0,c.ax)(n.emitterChain),n.sequence),guardianSetOld:_(e,n.guardianSet),guardianSetNew:_(e,n.guardianSet+1),systemProgram:c.$.programId}}function oe(e,t,n,r){const{newContract:i}=n.payload.actionArgs;return{payer:new c.P(t),bridge:P(e),vaa:D(e,c.d.Buffer.from(n.hash)),claim:b(e,n.emitterAddress.toString(),(0,c.ax)(n.emitterChain),n.sequence),upgradeAuthority:N(e),spill:new c.P(void 0===r?t:r),implementation:new c.aM(i).unwrap(),programData:y(e),wormholeProgram:new c.P(e),rent:c.a2,clock:c.a1,bpfLoaderUpgradeable:f,systemProgram:c.$.programId}}function ce(e,t){return{bridge:P(e),guardianSet:_(e,0),feeCollector:z(e),payer:new c.P(t),clock:c.a1,rent:c.a2,systemProgram:c.$.programId}}function ue(e,t,n,r,i,a,s){const o=ne(t,e).methods.postMessage(a,c.d.Buffer.from(i),s);return o._ixFn(...o._args,{accounts:de(t,n,r),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})}function de(e,t,n,r){let i;return r?({emitter:r,sequence:i}=T(r,e)):i=L(r=t,e),{bridge:P(e),message:new c.P(n),emitter:new c.P(r),sequence:i,payer:new c.P(t),feeCollector:z(e),clock:c.a1,rent:c.a2,systemProgram:c.$.programId}}function ge(e,t,n,r,i){const a=ne(t,e).methods.postVaa(1,r.guardianSet,r.timestamp,r.nonce,(0,c.ax)(r.emitterChain),[...r.emitterAddress.toUint8Array()],new c.b6(r.sequence.toString()),r.consistencyLevel,c.d.Buffer.from((0,c.dv)(r.payloadLiteral,r.payload)));return a._ixFn(...a._args,{accounts:me(t,n,i,r),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})}function me(e,t,n,r){return{guardianSet:_(e,r.guardianSet),bridge:P(e),signatureSet:new c.P(n),vaa:D(e,c.d.Buffer.from(r.hash)),payer:new c.P(t),clock:c.a1,rent:c.a2,systemProgram:c.$.programId}}async function le(e,t,n,r,i,a){const s=r.guardianSet,o=await V(e,t,s,a),u=r.signatures,d=o.keys,g=[];for(let m=0;m<Math.ceil(u.length/7);++m){const a=7*m,s=Math.min(u.length,7*(m+1)),o=new Array(19).fill(-1),l=[],p=[];for(let e=0;e<s-a;++e){const t=u.at(e+a);l.push(c.d.Buffer.from(t.signature.encode())),p.push(d.at(t.guardianIndex)),o[t.guardianIndex]=e}g.push(F(l,p,c.d.Buffer.from(r.hash))),g.push(pe(e,t,n,r,i,o))}return g}function pe(e,t,n,r,i,a){const s=ne(t,e).methods.verifySignatures(a);return s._ixFn(...s._args,{accounts:fe(t,n,i,r),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})}function fe(e,t,n,r){return{payer:new c.P(t),guardianSet:_(e,r.guardianSet),signatureSet:new c.P(n),instructions:c.dw,rent:c.a2,systemProgram:c.$.programId}}function ye(e,t){const{emitter:n,sequence:r}=T(e,t);return{wormholeBridge:P(t),wormholeEmitter:n,wormholeSequence:r,wormholeFeeCollector:z(t)}}function he(e,t,n,r){const i=de(t,n,r,e);return{payer:i.payer,wormholeBridge:i.bridge,wormholeMessage:i.message,wormholeEmitter:i.emitter,wormholeSequence:i.sequence,wormholeFeeCollector:i.feeCollector,clock:i.clock,rent:i.rent,systemProgram:i.systemProgram}}const we=Object.freeze(Object.defineProperty({__proto__:null,BridgeConfig:B,BridgeData:E,GuardianSetData:W,SequenceTracker:C,SignatureSetData:G,coder:re,createBridgeFeeTransferInstruction:O,createInitializeInstruction:function(e,t,n,r,i,a){const s=ne(t,e).methods.initialize(r,new c.b6(i.toString()),[...a.map(e=>[...new Uint8Array(e)])]);return s._ixFn(...s._args,{accounts:ce(t,n),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})},createPostMessageInstruction:ue,createPostVaaInstruction:ge,createReadOnlyWormholeProgramInterface:ne,createSetFeesInstruction:function(e,t,n,r){const i=ne(t,e).methods.setFees();return i._ixFn(...i._args,{accounts:ie(t,n,r),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})},createTransferFeesInstruction:function(e,t,n,r,i){const a=ne(t,e).methods.transferFees();return a._ixFn(...a._args,{accounts:ae(t,n,r,i),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})},createUpgradeContractInstruction:function(e,t,n,r){const i=ne(t,e).methods.upgradeContract();return i._ixFn(...i._args,{accounts:oe(t,n,r),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})},createUpgradeGuardianSetInstruction:function(e,t,n,r){const i=ne(t,e).methods.upgradeGuardianSet();return i._ixFn(...i._args,{accounts:se(t,n,r),signers:void 0,remainingAccounts:void 0,preInstructions:void 0,postInstructions:void 0})},createVerifySignaturesInstructions:le,createWormholeProgramInterface:te,deriveClaimKey:b,deriveEmitterSequenceKey:L,deriveFeeCollectorKey:z,deriveGuardianSetKey:_,derivePostedVaaKey:D,deriveUpgradeAuthorityKey:N,deriveWormholeBridgeDataKey:P,deriveWormholeEmitterKey:k,getClaim:A,getEmitterKeys:T,getGuardianSet:V,getInitializeAccounts:ce,getPostMessageAccounts:de,getPostMessageCpiAccounts:he,getPostVaaAccounts:me,getProgramSequenceTracker:q,getSequenceTracker:U,getSetFeesAccounts:ie,getSignatureSetData:async function(e,t,n){return e.getAccountInfo(new c.P(t),n).then(e=>G.deserialize((0,d.g)(e)))},getTransferFeesAccounts:ae,getUpgradeContractAccounts:oe,getUpgradeGuardianSetAccounts:se,getVerifySignatureAccounts:fe,getWormholeBridgeData:x,getWormholeDerivedAccounts:ye},Symbol.toStringTag,{value:"Module"})),Se="Program log: Sequence: ";class ve{constructor(e,t,n,r){p(this,"network"),p(this,"chain"),p(this,"connection"),p(this,"contracts"),p(this,"chainId"),p(this,"coreBridge"),p(this,"address"),p(this,"bridgeData"),this.network=e,this.chain=t,this.connection=n,this.contracts=r,this.chainId=(0,c.ax)(t);const i=r.coreBridge;if(!i)throw new Error("CoreBridge contract Address for chain ".concat(t," not found"));this.address=i,this.coreBridge=ne(i,n)}async getGuardianSet(e){const t=await V(this.connection,this.coreBridge.programId,e);return{index:t.index,keys:t.keys.map(e=>e.toString("hex")),expiry:BigInt(t.expirationTime)}}static async fromRpc(e,t){const[n,r]=await g.a.chainFromRpc(e),i=t[r];if(i.network!==n)throw new Error("Network mismatch for chain ".concat(r,": ").concat(i.network," != ").concat(n));return new ve(n,r,e,t[r].contracts)}async ensureBridgeConfig(){this.bridgeData||(this.bridgeData=await x(this.connection,this.coreBridge.programId))}async getMessageFee(){return await this.ensureBridgeConfig(),this.bridgeData.config.fee}async getGuardianSetIndex(){return await this.ensureBridgeConfig(),this.bridgeData.guardianSetIndex}publishMessage(e,t,n,r){var i=this;return(0,o.A)(function*(){const a=c.a0.generate(),o=new c.aM(e).unwrap(),u=ue(i.connection,i.coreBridge.programId,o,a.publicKey,t,n,r),d=yield(0,s.A)(i.getMessageFee()),g=O(i.coreBridge.programId,o,d),m=new c.aN;m.feePayer=o,m.add(g,u),yield i.createUnsignedTx({transaction:m,signers:[a]},"Core.PublishMessage")})()}verifyMessage(e,t){var n=this;return(0,o.A)(function*(){yield*(0,i.A)((0,a.A)(n.postVaa(e,t)),s.A)})()}postVaa(e,t){var n=this;return(0,o.A)(function*(){const r=D(n.coreBridge.programId,c.d.Buffer.from(t.hash));if(yield(0,s.A)(n.connection.getAccountInfo(r)))return;const i=new c.aM(e).unwrap(),a=c.a0.generate(),o=yield(0,s.A)(le(n.connection,n.coreBridge.programId,i,t,a.publicKey));for(let e=0;e<o.length;e+=2){const t=(new c.aN).add(...o.slice(e,e+2));t.feePayer=i,yield n.createUnsignedTx({transaction:t,signers:[a]},"Core.VerifySignature",!0)}const u=(new c.aN).add(ge(n.connection,n.coreBridge.programId,i,t,a.publicKey));u.feePayer=i,yield n.createUnsignedTx({transaction:u},"Core.PostVAA")})()}static parseSequenceFromLog(e,t){var n,r,i,a;const{meta:s,transaction:{message:o}}=t;if(null==(n=null==s?void 0:s.innerInstructions)||!n.length)return[];const u=o.staticAccountKeys;if(0===u.filter(t=>t.toString()===e).length)return[];const d=null==(a=null==(i=null==(r=null==s?void 0:s.logMessages)?void 0:r.filter(e=>e.startsWith(Se)))?void 0:i[0])?void 0:a.replace(Se,"");if(!d)return[];const g=[];for(const c of null==s?void 0:s.innerInstructions){const t=c.instructions;g.push(...t.filter(t=>t.programIdIndex in u&&u[t.programIdIndex].toString()===e))}return g.length<1||u.length<3?[]:g.map(e=>[new c.aM(u[e.accounts[2]]).toUniversalAddress(),BigInt(d)]).filter(e=>null!==e)}async getMessageAccountKeys(e){let t;if("string"!=typeof e.transaction.message.version)if(e.meta.loadedAddresses)t=e.transaction.message.getAccountKeys({accountKeysFromLookups:e.meta.loadedAddresses});else{const n=await Promise.all(e.transaction.message.addressTableLookups.map(async e=>{const t=await this.connection.getAddressLookupTable(e.accountKey);if(!t||!t.value)throw new Error("Could not resolve lookup table: "+e.accountKey.toBase58());return t.value}));t=e.transaction.message.getAccountKeys({addressLookupTableAccounts:n})}else t=e.transaction.message.getAccountKeys();return t}async findInstructions(e,t){var n;const{meta:r,transaction:{message:i}}=t,a=this.coreBridge.programId;return[...null==(n=r.innerInstructions)?void 0:n.flatMap(t=>t.instructions.filter(t=>a.toString()===e.get(t.programIdIndex).toString())).map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts})),...i.compiledInstructions.filter(t=>a.toString()===e.get(t.programIdIndex).toString())]}async parsePostMessageAccount(e){const t=await this.connection.getAccountInfo(e);if(null==t||!t.data)throw new Error("No data found in message account");const{timestamp:n,emitterAddress:r,emitterChain:i,consistencyLevel:a,sequence:s,nonce:o,payload:u}=M(new Uint8Array(null==t?void 0:t.data));return(0,m.c)("Uint8Array",{guardianSet:await this.getGuardianSetIndex(),emitterChain:(0,c.ad)(i),timestamp:n,emitterAddress:r,consistencyLevel:a,sequence:s,nonce:o,payload:u,signatures:[]})}async parseTransaction(e){const t=await this.connection.getTransaction(e,{maxSupportedTransactionVersion:0});if(!t||!t.meta||!t.meta.innerInstructions)throw new Error("transaction not found");try{const e=ve.parseSequenceFromLog(this.coreBridge.programId.toBase58(),t);if(e.length>0){const[t,n]=e[0];return[{chain:this.chain,emitter:t,sequence:n}]}}catch(a){}const n=await this.getMessageAccountKeys(t),r=await this.findInstructions(n,t);if(!r||0===r.length)throw new Error("no bridge messages found");const i=r.map(async e=>{const t=n.get(e.accountKeyIndexes[1]),r=await this.parsePostMessageAccount(t);return{chain:r.emitterChain,emitter:r.emitterAddress,sequence:r.sequence}});return await Promise.all(i)}async parseMessages(e){const t=await this.connection.getTransaction(e,{maxSupportedTransactionVersion:0});if(!t||!t.meta||!t.meta.innerInstructions)throw new Error("transaction not found");const n=await this.getMessageAccountKeys(t),r=await this.findInstructions(n,t);if(!r||0===r.length)throw new Error("no bridge messages found");const i=r.map(async e=>{const t=n.get(e.accountKeyIndexes[1]);return await this.parsePostMessageAccount(t)});return await Promise.all(i)}createUnsignedTx(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new g.S(e,this.network,this.chain,t,n)}}(0,c.aF)(c.aO,"WormholeCore",ve);const Ie=Object.freeze(Object.defineProperty({__proto__:null,IDL:ee,SolanaWormholeCore:ve,deserializePostMessage:M,postMessageLayout:I,utils:we},Symbol.toStringTag,{value:"Module"}))},7605:(e,t,n)=>{n.d(t,{c:()=>s});var r=n(9379),i=n(1640);function a(e){return[...i.dB,(0,i.dC)(e)]}function s(e,t){const[n,s]=(0,i.dz)(e),o=(0,i.dA)(a(e),t);return(0,r.A)((0,r.A)((0,r.A)({protocolName:n,payloadName:s,payloadLiteral:e},(0,i.dA)(i.dD,t)),o),{},{hash:(0,i.aw)((0,i.av)(a(e),o))})}},8456:(e,t,n)=>{n.d(t,{a:()=>o,d:()=>a,g:()=>c,n:()=>s});var r=n(1640);const i=e=>"string"==typeof e?r.d.Buffer.from(e):e;function a(e,t){return r.P.findProgramAddressSync(Array.isArray(e)?e.map(i):[i(e)],new r.P(t))[0]}function s(e,t){return{pubkey:new r.P(e),isWritable:!0,isSigner:t}}function o(e,t){return{pubkey:new r.P(e),isWritable:!1,isSigner:t}}function c(e){if(null===e)throw Error("account info is null");return e.data}}}]);
//# sourceMappingURL=5010.9ff50d79.chunk.js.map